<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=Cache-Control content="max-age=259200"><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><a rel=me href=https://emacs.ch/@justin></a><title>Literate Kedro: Using Org-mode for Data Science | justin.vc</title>
<meta name=keywords content="org,kedro,python,data-science,emacs"><meta name=description content='Summary This is both a general(ish) explainer and template(s) for usage in data science, specifically utilizing (formerly) Quantum Black&rsquo;s now open-source (Linux Foundation) framework for creating reproducible, maintainable, and modular data science code. What does that mean? At its most simple it basically ties things into "nodes" and "pipelines", where nodes are utility functions and functions that tie things together, and pipelines chain together multiple nodes, allowing for steps to be easily repeated.'><meta name=author content="Justin"><link rel=canonical href=https://justin.vc/posts/literate-kedro-spaceflight/><link crossorigin=anonymous href=/assets/css/stylesheet.min.50ce1499d3a64fcc663dee9b586f2cf3e98355eb042f1ebbea722a629674acc1.css integrity="sha256-UM4UmdOmT8xmPe6bWG8s8+mDVesELx676nIqYpZ0rME=" rel="preload stylesheet" as=style><link rel=icon href=https://justin.vc/earthbound-globe.png><link rel=apple-touch-icon href=https://justin.vc/apple-touch-icon.png><link rel=alternate hreflang=en href=https://justin.vc/posts/literate-kedro-spaceflight/><meta name=twitter:image content="https://justin.vc/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:card property="twitter:card" content="summary"><meta name=twitter:title content="Literate Kedro: Using Org-mode for Data Science | justin.vc"><meta name=twitter:description content='Summary This is both a general(ish) explainer and template(s) for usage in data science, specifically utilizing (formerly) Quantum Black&rsquo;s now open-source (Linux Foundation) framework for creating reproducible, maintainable, and modular data science code. What does that mean? At its most simple it basically ties things into "nodes" and "pipelines", where nodes are utility functions and functions that tie things together, and pipelines chain together multiple nodes, allowing for steps to be easily repeated.'><meta name=twitter:site content><meta name=twitter:creator content><meta property="og:title" content="Literate Kedro: Using Org-mode for Data Science | justin.vc"><meta property="og:description" content='Summary This is both a general(ish) explainer and template(s) for usage in data science, specifically utilizing (formerly) Quantum Black&rsquo;s now open-source (Linux Foundation) framework for creating reproducible, maintainable, and modular data science code. What does that mean? At its most simple it basically ties things into "nodes" and "pipelines", where nodes are utility functions and functions that tie things together, and pipelines chain together multiple nodes, allowing for steps to be easily repeated.'><meta property="og:type" content="article"><meta property="og:url" content="https://justin.vc/posts/literate-kedro-spaceflight/"><meta property="og:image" content="https://justin.vc/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-07-25T01:43:00-04:00"><meta property="article:modified_time" content="2022-08-01T05:41:48-04:00"><meta property="og:site_name" content="justin.vc"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://justin.vc/posts/"},{"@type":"ListItem","position":2,"name":"Literate Kedro: Using Org-mode for Data Science","item":"https://justin.vc/posts/literate-kedro-spaceflight/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Literate Kedro: Using Org-mode for Data Science | justin.vc","name":"Literate Kedro: Using Org-mode for Data Science","description":"Summary This is both a general(ish) explainer and template(s) for usage in data science, specifically utilizing (formerly) Quantum Black\u0026rsquo;s now open-source (Linux Foundation) framework for creating reproducible, maintainable, and modular data science code. What does that mean? At its most simple it basically ties things into \u0026quot;nodes\u0026quot; and \u0026quot;pipelines\u0026quot;, where nodes are utility functions and functions that tie things together, and pipelines chain together multiple nodes, allowing for steps to be easily repeated.","keywords":["org","kedro","python","data-science","emacs"],"wordCount":"1929","inLanguage":"en","datePublished":"2022-07-25T01:43:00-04:00","dateModified":"2022-08-01T05:41:48-04:00","author":[{"@type":"Person","name":"Justin"}],"mainEntityOfPage":{"@type":"WebPage","@id":"https://justin.vc/posts/literate-kedro-spaceflight/"},"publisher":{"@type":"Organization","name":"justin.vc","logo":{"@type":"ImageObject","url":"https://justin.vc/earthbound-globe.png"}}}</script><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript></head><body class=dark id=top><style>body{visibility:visible}</style><script>const storageKey="pref-theme",onClick=()=>{const e=isDarkTheme();setPrefTheme(e?"light":"dark")},isDarkTheme=()=>document.body.classList.contains("dark"),getPrefTheme=()=>{const e=localStorage.getItem(storageKey);return e?e:window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"},setPrefTheme=e=>{localStorage.setItem(storageKey,e),reflectPreference(e)},reflectPreference=e=>{e==="dark"?(document.body.classList.add("dark"),document.firstElementChild.setAttribute("data-theme","dark")):(document.body.classList.remove("dark"),document.firstElementChild.setAttribute("data-theme","light")),setTimeout(()=>{document.body.classList.add("theme-loaded")},50)};(function(){const e=getPrefTheme();reflectPreference(e)})(),document.addEventListener("DOMContentLoaded",function(){document.querySelector("#theme-toggle").addEventListener("click",onClick),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",({matches:e})=>{setPrefTheme(e?"dark":"light")}),window.addEventListener("toggle-theme",function(){onClick()})})</script><div class=right-container><div class=right-box><a href=/ title="Travel to home page"><svg width="20" height="20" stroke="currentcolor" fill="currentcolor" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><path d="M31.772 16.043l-15.012-15.724c-.189-.197-.449-.307-.721-.307s-.533.111-.722.307l-15.089 15.724c-.383.398-.369 1.031.029 1.414.399.382 1.031.371 1.414-.029l1.344-1.401V30.99c0 .552.448 1 1 1h6.986c.551.0.998-.445 1-.997l.031-9.989h7.969v9.986c0 .552.448 1 1 1h6.983c.552.0 1-.448 1-1V16.022l1.343 1.407c.197.204.459.308.722.308.249.0.499-.092.692-.279.398-.382.411-1.015.029-1.413zm-4.787-1.83v15.776h-4.983v-9.986c0-.552-.448-1-1-1h-9.965c-.551.0-.998.445-1 .997l-.031 9.989H5.017V14.212c0-.082-.013-.162-.032-.239L16.04 2.453 27.022 13.96c-.021.081-.036.165-.036.252z"/></svg>
</a><a href=/search title="Travel to /search page"><svg height="20" width="20" id="_x32_" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 512 512" stroke="currentcolor" fill="currentcolor"><g><path class="st0" d="M312.069 53.445c-71.26-71.26-187.194-71.26-258.454.0-71.261 71.26-71.261 187.206.0 258.466 71.26 71.26 187.194 71.26 258.454.0s71.26-187.206.0-258.466zM286.694 286.536c-57.351 57.34-150.353 57.34-207.704-.011s-57.351-150.353.0-207.693c57.351-57.351 150.342-57.351 207.693.0S344.045 229.174 286.694 286.536z"/><path class="st0" d="M101.911 112.531c-29.357 37.725-31.801 89.631-7.321 129.702 1.877 3.087 5.902 4.048 8.978 2.182 3.065-1.888 4.037-5.903 2.16-8.978-21.666-35.456-19.506-81.538 6.469-114.876 2.226-2.837 1.713-6.938-1.135-9.154C108.227 109.193 104.125 109.695 101.911 112.531z"/><path class="st0" d="M498.544 447.722l-132.637-129.2c-7.255-7.07-18.84-6.982-26.008.174l-21.033 21.033c-7.156 7.156-7.234 18.742-.153 25.986l129.19 132.636c14.346 17.324 35.542 18.35 51.917 1.964C516.216 483.951 515.857 462.068 498.544 447.722z"/></g></svg></a></div><div class=right-box><button class=theme-toggle id=theme-toggle title="Toggles light & dark" aria-label=auto aria-live=polite><svg class="sun-and-moon" aria-hidden="true" width="24" height="24" viewBox="0 0 24 24"><mask class="moon" id="moon-mask"><rect x="0" y="0" width="100%" height="100%" fill="#fff"/><circle cx="24" cy="10" r="6" fill="#000"/></mask><circle class="sun" cx="12" cy="12" r="6" mask="url(#moon-mask)" fill="currentcolor"/><g class="sun-beams" stroke="currentcolor"><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></g></svg></button></div><div class=right-box><button id=toggle-reader-on title="toggle 'reader mode' on - hiding unncessary elements and expanding width of body. Works on post pages only.">
<svg height="20" width="20" stroke="currentcolor" fill="currentcolor" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 472.615 472.615"><g><g><path d="M246.153 55.558v402.885c74.135-34.307 152.741-47.774 226.463-38.569.0-134.295.0-268.589.0-402.884C398.896 7.786 320.289 21.252 246.153 55.558z"/></g></g><g><g><path d="M.001 16.99C0 151.285.0 285.579.001 419.874c73.719-9.204 152.325 4.262 226.46 38.568V55.557C152.324 21.252 73.719 7.786.001 16.99z"/></g></g></svg>
</button>
<button id=toggle-reader-off class=toggled title="toggle 'reader mode' off - this is the default site experience"><svg height="20" width="20" stroke="currentcolor" fill="currentcolor" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 492.308 492.308"><g><g><path d="M483.683 14.104c-77.81-9.724-159.79 4.885-237.529 42.096C168.418 18.988 86.412 4.409 8.625 14.104L0 15.181v422.731l11.067-1.385c75.327-9.413 155.072 5.183 230.519 42.154l1.237.603 3.018 1.791.325-.159.444.216 3.227-2.014.811-.399c75.519-37.019 155.236-51.587 230.591-42.192l11.067 1.385V15.181L483.683 14.104zM236.308 454.431c-59.058-26.692-120.351-40.375-180.202-40.375-12.207.0-24.361.567-36.413 1.712V32.671c70.966-7.077 145.577 6.856 216.615 40.587V454.431zm236.307-38.664c-71.048-6.683-145.346 6.51-216.615 38.683V73.257c71.038-33.731 145.611-47.683 216.615-40.587V415.767z"/></g></g></svg></button></div></div><script>const topRightDiv=document.querySelector(".right-container");function handleScroll(){window.scrollY>150?topRightDiv.classList.add("fade-out"):topRightDiv.classList.remove("fade-out")}window.addEventListener("scroll",handleScroll),document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("toggle-reader-on"),e=document.getElementById("toggle-reader-off"),n=document.querySelector("main"),s=document.querySelector(".main.post"),o=document.querySelector(".post-single"),i=document.querySelector(".toc.side"),a=document.querySelector(".header"),r=localStorage.getItem("readerMode");e.disabled=!0,r==="enabled"?(n&&n.classList.add("reduced-padding"),s&&s.classList.add("full-width"),o&&o.classList.add("margin-expanded"),i&&i.classList.toggle("side"),a.classList.toggle("hidden"),t.classList.add("toggled"),t.disabled=!0,e.classList.remove("toggled"),e.disabled=!1,localStorage.setItem("readerMode","enabled")):e.disabled=!0,t.addEventListener("click",()=>{n&&n.classList.add("reduced-padding"),s&&s.classList.add("full-width"),o&&o.classList.add("margin-expanded"),i&&i.classList.toggle("side"),a.classList.toggle("hidden"),localStorage.setItem("readerMode","enabled"),t.classList.add("toggled"),t.disabled=!0,e.classList.remove("toggled"),e.disabled=!1}),e.addEventListener("click",()=>{n&&n.classList.remove("reduced-padding"),s&&s.classList.remove("full-width"),o&&o.classList.remove("margin-expanded"),i&&i.classList.toggle("side"),a.classList.toggle("hidden"),localStorage.setItem("readerMode","disabled"),e.classList.add("toggled"),e.disabled=!0,t.classList.remove("toggled"),t.disabled=!1})})</script><header class=header><nav class=nav><div class=ascii-art id=ascii1 style=display:none><i class="fas fa-palette"></i>
<a href=/><pre>
          â–„â–„â–„â–„â–„      â–„     â–„â–„â–„â–„â–„      â–„â–„â–„â–„â–€ â–„â–ˆ    â–„          â–„   â–„â–ˆâ–„    
         â–„â–€  â–ˆ       â–ˆ    â–ˆ     â–€â–„ â–€â–€â–€ â–ˆ    â–ˆâ–ˆ     â–ˆ          â–ˆ  â–ˆâ–€ â–€â–„  
             â–ˆ    â–ˆ   â–ˆ â–„  â–€â–€â–€â–€â–„       â–ˆ    â–ˆâ–ˆ â–ˆâ–ˆ   â–ˆ    â–ˆ     â–ˆ â–ˆ   â–€  
           â–„ â–ˆ    â–ˆ   â–ˆ  â–€â–„â–„â–„â–„â–€       â–ˆ     â–â–ˆ â–ˆ â–ˆ  â–ˆ     â–ˆ    â–ˆ â–ˆâ–„  â–„â–€ 
            â–€     â–ˆâ–„ â–„â–ˆ              â–€       â– â–ˆ  â–ˆ â–ˆ <a class=color>â–ˆâ–ˆ</a><a href=/>   â–ˆ  â–ˆ  â–€â–ˆâ–ˆâ–ˆâ–€  
                   â–€â–€â–€                         â–ˆ   â–ˆâ–ˆ       â–ˆâ–                     
            </pre></a></div><div class=ascii-art id=ascii12 style=display:none><i class="fas fa-palette"></i>
<a href=/><pre>      
        â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
        â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•
        â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     
   â–ˆâ–ˆ   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â•šâ•â•â•â•â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘   â•šâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘     
   â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘<a class=color href=/>â–ˆâ–ˆâ•—</a><a href=/> â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•”â• â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
    â•šâ•â•â•â•â•  â•šâ•â•â•â•â•â• â•šâ•â•â•â•â•â•â•   â•šâ•â•   â•šâ•â•â•šâ•â•  â•šâ•â•â•â•â•šâ•â•  â•šâ•â•â•â•   â•šâ•â•â•â•â•â•</pre></div><div class=ascii-art id=ascii13 style=display:none><i class="fas fa-palette"></i>
<a href=/><pre class=threed>
     ___      ___  ___     ________     _________    ___      ________          ___      ___  ________     
    |\  \    |\  \|\  \   |\   ____\   |\___   ___\ |\  \    |\   ___  \       |\  \    /  /||\   ____\    
    \ \  \   \ \  \\\  \  \ \  \___|_  \|___ \  \_| \ \  \   \ \  \\ \  \      \ \  \  /  / /\ \  \___|    
  __ \ \  \   \ \  \\\  \  \ \_____  \      \ \  \   \ \  \   \ \  \\ \  \      \ \  \/  / /  \ \  \       
 |\  \\_\  \   \ \  \\\  \  \|____|\  \      \ \  \   \ \  \   \ \  \\ \  \  <a class=color href=/>___</a><a href=/> \ \    / /    \ \  \____  
 \ \________\   \ \_______\   ____\_\  \      \ \__\   \ \__\   \ \__\\ \__\<a class=color href=/>|\__\</a><a href=/> \ \__/ /      \ \_______\
  \|________|    \|_______|  |\_________\      \|__|    \|__|    \|__| \|__|<a class=color href=/>\|__|</a><a href=/>  \|__|/        \|_______|</pre></div><div class=ascii-art id=ascii14 style=display:none><i class="fas fa-palette"></i>
<a href=/><pre class=smoll-ascii>
    (_)_   _ ___| |_(_)_ __ __   _____ 
    | | | | / __| __| | '_ \\ \ / / __|
    | | |_| \__ \ |_| | | | |\ V / (__ 
   _/ |\__,_|___/\__|_|_| |_<a class=color href=/>(_)</a>_/ \___|
   |__/</pre></a></div><ul id=menu><li><a href=https://justin.vc/about/ title=About>About</a></li><li><a href=https://justin.vc/now/ title=Now>Now</a></li><li><a href=https://justin.vc/tags/ title=Tags>Tags</a></li><li><a href=https://justin.vc/elfeed/ title=Links>Links</a></li></ul></nav></header><style>div.ascii-art{display:flex;align-items:center;justify-content:center}.color{color:var(--link-header-color)}header pre{font-size:6px;font-family:courier new,Courier,monospace;line-height:1;margin:0}.threed{font-size:5px}.smoll-ascii{font-size:8px}@media(max-width:630px){header pre{font-size:5px;line-height:1}.threed{font-size:3px}#menu a{padding:0;margin:0}}</style><script>document.addEventListener("DOMContentLoaded",function(){var e=document.querySelectorAll(".ascii-art"),t=Math.floor(Math.random()*e.length);e[t].style.display="block"})</script><main class="main post"><article class=post-single><div class=breadcrumbs><a href=https://justin.vc/>Home</a>&nbsp;Â»&nbsp;<a href=https://justin.vc/posts/>Posts</a></div><h1 class=post-title>Literate Kedro: Using Org-mode for Data Science</h1><div class=post-meta><span class=meta-item><span class=post-date>&#160;2022/07/25&#160;
<b><a href=https://github.com/brickfrog/justin.vc/commits/master/content/posts/literate-kedro-spaceflight.md>âŸ¹</a></b>
&#160;<u><a href=https://raw.githubusercontent.com/brickfrog/justin.vc/master/content/posts/literate-kedro-spaceflight.md>2022/08/01</a></u>
</span></span><span class=meta-item><span class=post-tags>&#160;<a href=https://justin.vc/tags/org/>Org</a><a href=https://justin.vc/tags/kedro/>Kedro</a><a href=https://justin.vc/tags/python/>Python</a><a href=https://justin.vc/tags/data-science/>Data-Science</a><a href=https://justin.vc/tags/emacs/>Emacs</a></span></span></div><div class=dingbat>ğŸ™</div><div class="toc side left"><details open><summary><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#summary aria-label=Summary>Summary</a><ul><li><a href=#assumptions aria-label=Assumptions>Assumptions</a></li></ul></li><li><a href=#kedro-spaceflights-tutorial aria-label="Kedro Spaceflights Tutorial">Kedro Spaceflights Tutorial</a><ul><li><a href=#setup aria-label=Setup>Setup</a><ul><li><a href=#emacs-and-shell aria-label="Emacs and Shell">Emacs and Shell</a></li><li><a href=#requirements-dot-txt aria-label=requirements.txt>requirements.txt</a></li><li><a href=#configuration aria-label=Configuration>Configuration</a></li></ul></li><li><a href=#data aria-label=Data>Data</a><ul><li><a href=#preparation aria-label=Preparation>Preparation</a></li></ul></li><li><a href=#pipelines aria-label=Pipelines>Pipelines</a></li></ul></li><li><a href=#conclusions aria-label=Conclusions>Conclusions</a></li></ul></div></details></div><div class=post-content><h2 id=summary>Summary<a hidden class=anchor aria-hidden=true href=#summary>Â¶</a></h2><p>This is both a general(ish) explainer and template(s) for usage in data science,
specifically utilizing (formerly) Quantum Black&rsquo;s now open-source (Linux
Foundation) framework for creating <span class=sidenote><label class=sidenote-label for=f1>reproducible, maintainable, and modular data science code.</label>
<input class=sidenote-checkbox type=checkbox id=f1></input>
<span class="sidenote-content
sidenote-right">What does that mean? At its most simple it basically ties things into "nodes" and "pipelines", where nodes are utility functions and functions that tie things together, and pipelines chain together multiple nodes, allowing for steps to be easily repeated. DAGs, they&rsquo;re all the rage. </span></span>Make sure to read their tutorial if you&rsquo;re not
familiar with it, it&rsquo;s good (and I won&rsquo;t be covering nearly as much as there,
it&rsquo;s under the assumption you&rsquo;ve skimmed it):</p><p><a href=https://kedro.readthedocs.io/en/stable/tutorial/spaceflights_tutorial.html>https://kedro.readthedocs.io/en/stable/tutorial/spaceflights_tutorial.html</a></p><p>Some benefits you get using it with org-mode and emacs, however:</p><ul><li>Single file navigation / no need-to bounce around VSCode haphazardly when you
can jump between headers and tangle to the appropriate places.</li><li>Transition to a presentation from inside Org-mode seamlessly</li><li>Include data exploration and other documentation in the same file.</li><li>Other languages with org-babel</li></ul><p>Kedro uses a <a href=https://kedro.readthedocs.io/en/stable/tutorial/spaceflights_tutorial.html#kedro-project-development-workflow>specific workflow</a> which I will follow for this template/tutorial.</p><p>I&rsquo;m not entirely sure how useful this will be, but it allows me to get some
practice with org-babel and a project excuse to tinker around with kedro some
more in a use-case that I haven&rsquo;t seen.</p><p>This will be more of a &ldquo;update as I come up with new ideas&rdquo; type of article,
and, of course, if you see something that would be better served by a different
method, feel free to leave a comment / issue.</p><p><strong>Highlevel / TLDR</strong>: <em>This is for using org to config Kedro. Similar to using a monolithic org
file for configing emacs. Geared towards people who already use emacs and use
something like ivy/helm/vertico to traverse headings easily.</em></p><h3 id=assumptions>Assumptions<a hidden class=anchor aria-hidden=true href=#assumptions>Â¶</a></h3><ul><li>I&rsquo;m using conda for environment management (conda.el / jupyter-python)</li><li>You&rsquo;ve created the kedro project already since there&rsquo;s the y/n steps insofar
as telemetry, etc.<ul><li>TODO: maybe put the steps here? Probably not worth the timesink insofar as a
template. The steps would 95% of the time be done in the command line but once.</li></ul></li></ul><h2 id=kedro-spaceflights-tutorial>Kedro Spaceflights Tutorial<a hidden class=anchor aria-hidden=true href=#kedro-spaceflights-tutorial>Â¶</a></h2><p><strong>Scenario:</strong> It is 2160 and the space tourism industry is booming. Globally,
thousands of space shuttle companies take tourists to the Moon and back. You
have been able to source amenities offered in each space shuttle, customer
reviews and company information.</p><p><strong>Project:</strong> You want to construct a model that predicts the price for each trip to
the Moon and the corresponding return flight.</p><h3 id=setup>Setup<a hidden class=anchor aria-hidden=true href=#setup>Â¶</a></h3><p>This is for environment setup, utility functions that you might not necessarily
want to put in your <code>init.el</code> or other things not directly related to the core of
the project.</p><h4 id=emacs-and-shell>Emacs and Shell<a hidden class=anchor aria-hidden=true href=#emacs-and-shell>Â¶</a></h4><ul><li><p>Elisp</p><p>Commands and utility functions that help reduce repeated code and make
the process more seamless. <span class=underline>Run manually with <code>C-c</code> <code>C-c</code>.</span> One could alternatively
add this to their <code>init.el</code>.</p><p>The following code is used to prevent org-mode from complaining about the
variables. Otherwise you can set these as local variables in a real-life scenario.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-elisp data-lang=elisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>projdir</span> <span class=s>&#34;~/code/literate-kedro&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>projsub</span> <span class=s>&#34;/src/literate_kedro&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nf>print</span> <span class=nv>projdir</span><span class=p>)</span>
</span></span></code></pre></div></li></ul><ul><li><p>Shell / Other</p><p>If you plan on using the terminal for all shell commands, this isn&rsquo;t necessary.
You can simply activate your conda environment with <code>conda-env-activate</code> under the
assumption you&rsquo;re using <code>conda.el</code>. Because the session is set at the top level,
it should persist through the following commands. See the echo commands below confirming.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>conda activate kedro-example
</span></span></code></pre></div><p>Making sure I&rsquo;m in the correct directory / using the correct environment.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>echo</span> <span class=k>$(</span><span class=nb>pwd</span><span class=k>)</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=k>$(</span>which pip<span class=k>)</span>
</span></span></code></pre></div></li></ul><h4 id=requirements-dot-txt>requirements.txt<a hidden class=anchor aria-hidden=true href=#requirements-dot-txt>Â¶</a></h4><p>The requirements for the kedro project in the form of a</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cfg data-lang=cfg><span class=line><span class=cl><span class=na>black~</span><span class=o>=</span><span class=s>22.0</span>
</span></span><span class=line><span class=cl><span class=na>flake8&gt;</span><span class=o>=</span><span class=s>3.7.9, &lt;4.0</span>
</span></span><span class=line><span class=cl><span class=na>ipython&gt;</span><span class=o>=</span><span class=s>7.31.1, &lt;8.0</span>
</span></span><span class=line><span class=cl><span class=na>isort~</span><span class=o>=</span><span class=s>5.0</span>
</span></span><span class=line><span class=cl><span class=na>jupyter~</span><span class=o>=</span><span class=s>1.0</span>
</span></span><span class=line><span class=cl><span class=na>jupyterlab~</span><span class=o>=</span><span class=s>3.0</span>
</span></span><span class=line><span class=cl><span class=na>kedro[pandas.CSVDataSet, pandas.ExcelDataSet, pandas.ParquetDataSet, plotly.PlotlyDataSet, plotly.JSONDataSet]</span><span class=o>=</span><span class=s>=0.18.2</span>
</span></span><span class=line><span class=cl><span class=na>kedro-telemetry~</span><span class=o>=</span><span class=s>0.2.0</span>
</span></span><span class=line><span class=cl><span class=na>kedro-viz~</span><span class=o>=</span><span class=s>4.7</span>
</span></span><span class=line><span class=cl><span class=na>nbstripout~</span><span class=o>=</span><span class=s>0.4</span>
</span></span><span class=line><span class=cl><span class=na>pytest-cov~</span><span class=o>=</span><span class=s>3.0</span>
</span></span><span class=line><span class=cl><span class=na>pytest-mock&gt;</span><span class=o>=</span><span class=s>1.7.1, &lt;2.0</span>
</span></span><span class=line><span class=cl><span class=na>pytest~</span><span class=o>=</span><span class=s>6.2</span>
</span></span><span class=line><span class=cl><span class=na>scikit-learn~</span><span class=o>=</span><span class=s>1.0</span>
</span></span></code></pre></div><h4 id=configuration>Configuration<a hidden class=anchor aria-hidden=true href=#configuration>Â¶</a></h4><p>The conf folder in kedro is for:</p><ul><li>Logging</li><li>Credentials</li><li>Other Sensitive/Personal content</li></ul><p>TODO: These are things that generally I would be more comfortable configuring outside
of org. You could probably get fancy with piping things with keys back and forth
but that remains outside of my scope for now.</p><p>You could probably get away with safely configing your logging here without
needing anything fancy.</p><ul><li><p>data_science.yml</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>data_science</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>active_modelling_pipeline</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>model_options</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>test_size</span><span class=p>:</span><span class=w> </span><span class=m>0.2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>random_state</span><span class=p>:</span><span class=w> </span><span class=m>3</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>features</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=l>engines</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=l>passenger_capacity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=l>crew</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=l>d_check_complete</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=l>moon_clearance_complete</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=l>iata_approved</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=l>company_rating</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=l>review_scores_rating</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>candidate_modelling_pipeline</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>model_options</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>test_size</span><span class=p>:</span><span class=w> </span><span class=m>0.2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>random_state</span><span class=p>:</span><span class=w> </span><span class=m>8</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>features</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=l>engines</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=l>passenger_capacity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=l>crew</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=l>review_scores_rating</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>data_processing.companies_columns</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>tracking.JSONDataSet</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>filepath</span><span class=p>:</span><span class=w> </span><span class=l>data/09_tracking/companies_columns.json</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>data_science.active_modelling_pipeline.metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>tracking.MetricsDataSet</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>filepath</span><span class=p>:</span><span class=w> </span><span class=l>data/09_tracking/metrics.json</span><span class=w>
</span></span></span></code></pre></div></li></ul><ul><li><p>settings.py</p><p>Normally you don&rsquo;t edit this, but there&rsquo;s some cases where it&rsquo;s necessary. This
is for storing metrics in a sqlite database.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>kedro_viz.integrations.kedro.sqlite_store</span> <span class=kn>import</span> <span class=n>SQLiteStore</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pathlib</span> <span class=kn>import</span> <span class=n>Path</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>SESSION_STORE_CLASS</span> <span class=o>=</span> <span class=n>SQLiteStore</span>
</span></span><span class=line><span class=cl><span class=n>SESSION_STORE_ARGS</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&#34;path&#34;</span><span class=p>:</span> <span class=nb>str</span><span class=p>(</span><span class=n>Path</span><span class=p>(</span><span class=vm>__file__</span><span class=p>)</span><span class=o>.</span><span class=n>parents</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>/</span> <span class=s2>&#34;data&#34;</span><span class=p>)}</span>
</span></span></code></pre></div></li></ul><h3 id=data>Data<a hidden class=anchor aria-hidden=true href=#data>Â¶</a></h3><p>The second part of the kedro workflow is the data phase, which involves adding
data to the <code>data</code> folder, and then referencing the datasets for the project in
the <code>conf/base/catalog.yml</code> file.</p><h4 id=preparation>Preparation<a hidden class=anchor aria-hidden=true href=#preparation>Â¶</a></h4><p>Steps involved in acquiring / registering the data to the appropriate
catalog(s). You could explain the business case or variables also.</p><ul><li><p>Acquisition</p><p>In some cases data is easily acquired with a curl/wget, specifically forone-off
analyses. It can also be helpful to show where you downloaded your data.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>mkdir -p <span class=nv>$directory</span>/
</span></span><span class=line><span class=cl><span class=c1>#reviews</span>
</span></span><span class=line><span class=cl>curl -o <span class=s2>&#34;</span><span class=nv>$directory</span><span class=s2>/reviews.csv&#34;</span> https://kedro-org.github.io/kedro/reviews.csv
</span></span><span class=line><span class=cl><span class=c1># companies</span>
</span></span><span class=line><span class=cl>curl -o <span class=s2>&#34;</span><span class=nv>$directory</span><span class=s2>/companies.csv&#34;</span> https://kedro-org.github.io/kedro/companies.csv
</span></span><span class=line><span class=cl><span class=c1># shuttles</span>
</span></span><span class=line><span class=cl>curl -o <span class=s2>&#34;</span><span class=nv>$directory</span><span class=s2>/shuttles.xlsx&#34;</span> https://kedro-org.github.io/kedro/shuttles.xlsx
</span></span></code></pre></div></li></ul><ul><li><p>Data Registration</p><ul><li><p>catalog.yml</p><p>You now need to register the datasets so they can be loaded by Kedro. All Kedro
projects have a <code>conf/base/catalog.yml</code>. file.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>companies</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>pandas.CSVDataSet</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>filepath</span><span class=p>:</span><span class=w> </span><span class=l>data/01_raw/companies.csv</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>layer</span><span class=p>:</span><span class=w> </span><span class=l>raw</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>reviews</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>pandas.CSVDataSet</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>filepath</span><span class=p>:</span><span class=w> </span><span class=l>data/01_raw/reviews.csv</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>layer</span><span class=p>:</span><span class=w> </span><span class=l>raw</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>shuttles</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>pandas.ExcelDataSet</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>filepath</span><span class=p>:</span><span class=w> </span><span class=l>data/01_raw/shuttles.xlsx</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>layer</span><span class=p>:</span><span class=w> </span><span class=l>raw</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>data_processing.preprocessed_companies</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>pandas.ParquetDataSet</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>filepath</span><span class=p>:</span><span class=w> </span><span class=l>data/02_intermediate/preprocessed_companies.pq</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>layer</span><span class=p>:</span><span class=w> </span><span class=l>intermediate</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>data_processing.preprocessed_shuttles</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>pandas.ParquetDataSet</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>filepath</span><span class=p>:</span><span class=w> </span><span class=l>data/02_intermediate/preprocessed_shuttles.pq</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>layer</span><span class=p>:</span><span class=w> </span><span class=l>intermediate</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>model_input_table</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>pandas.ParquetDataSet</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>filepath</span><span class=p>:</span><span class=w> </span><span class=l>data/03_primary/model_input_table.pq</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>layer</span><span class=p>:</span><span class=w> </span><span class=l>primary</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>data_science.active_modelling_pipeline.regressor</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>pickle.PickleDataSet</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>filepath</span><span class=p>:</span><span class=w> </span><span class=l>data/06_models/regressor_active.pickle</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>versioned</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>layer</span><span class=p>:</span><span class=w> </span><span class=l>models</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>data_science.candidate_modelling_pipeline.regressor</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>pickle.PickleDataSet</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>filepath</span><span class=p>:</span><span class=w> </span><span class=l>data/06_models/regressor_candidate.pickle</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>versioned</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>layer</span><span class=p>:</span><span class=w> </span><span class=l>models</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>data_science.active_modelling_pipeline.metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>tracking.MetricsDataSet</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>filepath</span><span class=p>:</span><span class=w> </span><span class=l>data/09_tracking/metrics.json</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>data_processing.companies_columns</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>tracking.JSONDataSet</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>filepath</span><span class=p>:</span><span class=w> </span><span class=l>data/09_tracking/companies_columns.json</span><span class=w>
</span></span></span></code></pre></div></li></ul></li></ul><h3 id=pipelines>Pipelines<a hidden class=anchor aria-hidden=true href=#pipelines>Â¶</a></h3><p>These are the node functions associated with the data_processing pipeline.</p><blockquote><p>In many typical Kedro projects, a single (â€œmainâ€) pipeline
increases in complexity as the project evolves. To keep your
project fit for purpose, you can create modular pipelines, which
are logically isolated and can be reused. Modular pipelines are
easier to develop, test and maintain, and are portable so they can
be copied and reused between projects.</p></blockquote><ul><li><p>data_processing</p><p>This pipeline is for processing the data.</p><ul><li><p>nodes.py</p><blockquote><p>A Kedro node is a wrapper for a Python function that names the inputs
and outputs of that function. It is the building block of a pipeline.
Nodes can be linked when the output of one node is the input of another.</p></blockquote><p>NOTE: Could theoretically break this into seperate codeblocks (import, utility,
preprocess, but might be a bit cumbersome. Input welcome for best practices.)</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>typing</span> <span class=kn>import</span> <span class=n>Tuple</span><span class=p>,</span> <span class=n>Dict</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pandas</span> <span class=k>as</span> <span class=nn>pd</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>_is_true</span><span class=p>(</span><span class=n>x</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>x</span> <span class=o>==</span> <span class=s2>&#34;t&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>_parse_percentage</span><span class=p>(</span><span class=n>x</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>x</span> <span class=o>=</span> <span class=n>x</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&#34;%&#34;</span><span class=p>,</span> <span class=s2>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>x</span> <span class=o>=</span> <span class=n>x</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>float</span><span class=p>)</span> <span class=o>/</span> <span class=mi>100</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>x</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>_parse_money</span><span class=p>(</span><span class=n>x</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>x</span> <span class=o>=</span> <span class=n>x</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&#34;$&#34;</span><span class=p>,</span> <span class=s2>&#34;&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&#34;,&#34;</span><span class=p>,</span> <span class=s2>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>x</span> <span class=o>=</span> <span class=n>x</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>float</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>x</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>preprocess_companies</span><span class=p>(</span><span class=n>companies</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span> <span class=n>Dict</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Preprocesses the data for companies.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    Args:
</span></span></span><span class=line><span class=cl><span class=s2>        companies: Raw data.
</span></span></span><span class=line><span class=cl><span class=s2>    Returns:
</span></span></span><span class=line><span class=cl><span class=s2>        Preprocessed data, with `company_rating` converted to a float and
</span></span></span><span class=line><span class=cl><span class=s2>        `iata_approved` converted to boolean.
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>companies</span><span class=p>[</span><span class=s2>&#34;iata_approved&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=n>_is_true</span><span class=p>(</span><span class=n>companies</span><span class=p>[</span><span class=s2>&#34;iata_approved&#34;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=n>companies</span><span class=p>[</span><span class=s2>&#34;company_rating&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=n>_parse_percentage</span><span class=p>(</span><span class=n>companies</span><span class=p>[</span><span class=s2>&#34;company_rating&#34;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>companies</span><span class=p>,</span> <span class=p>{</span><span class=s2>&#34;columns&#34;</span><span class=p>:</span> <span class=n>companies</span><span class=o>.</span><span class=n>columns</span><span class=o>.</span><span class=n>tolist</span><span class=p>(),</span> <span class=s2>&#34;data_type&#34;</span><span class=p>:</span> <span class=s2>&#34;companies&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>preprocess_shuttles</span><span class=p>(</span><span class=n>shuttles</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Preprocesses the data for shuttles.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    Args:
</span></span></span><span class=line><span class=cl><span class=s2>        shuttles: Raw data.
</span></span></span><span class=line><span class=cl><span class=s2>    Returns:
</span></span></span><span class=line><span class=cl><span class=s2>        Preprocessed data, with `price` converted to a float and `d_check_complete`,
</span></span></span><span class=line><span class=cl><span class=s2>        `moon_clearance_complete` converted to boolean.
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>shuttles</span><span class=p>[</span><span class=s2>&#34;d_check_complete&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=n>_is_true</span><span class=p>(</span><span class=n>shuttles</span><span class=p>[</span><span class=s2>&#34;d_check_complete&#34;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=n>shuttles</span><span class=p>[</span><span class=s2>&#34;moon_clearance_complete&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=n>_is_true</span><span class=p>(</span><span class=n>shuttles</span><span class=p>[</span><span class=s2>&#34;moon_clearance_complete&#34;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=n>shuttles</span><span class=p>[</span><span class=s2>&#34;price&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=n>_parse_money</span><span class=p>(</span><span class=n>shuttles</span><span class=p>[</span><span class=s2>&#34;price&#34;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>shuttles</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>create_model_input_table</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>shuttles</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span> <span class=n>companies</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span> <span class=n>reviews</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span>
</span></span><span class=line><span class=cl><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Combines all data to create a model input table.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    Args:
</span></span></span><span class=line><span class=cl><span class=s2>        shuttles: Preprocessed data for shuttles.
</span></span></span><span class=line><span class=cl><span class=s2>        companies: Preprocessed data for companies.
</span></span></span><span class=line><span class=cl><span class=s2>        reviews: Raw data for reviews.
</span></span></span><span class=line><span class=cl><span class=s2>    Returns:
</span></span></span><span class=line><span class=cl><span class=s2>        model input table.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>rated_shuttles</span> <span class=o>=</span> <span class=n>shuttles</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span><span class=n>reviews</span><span class=p>,</span> <span class=n>left_on</span><span class=o>=</span><span class=s2>&#34;id&#34;</span><span class=p>,</span> <span class=n>right_on</span><span class=o>=</span><span class=s2>&#34;shuttle_id&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>model_input_table</span> <span class=o>=</span> <span class=n>rated_shuttles</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>companies</span><span class=p>,</span> <span class=n>left_on</span><span class=o>=</span><span class=s2>&#34;company_id&#34;</span><span class=p>,</span> <span class=n>right_on</span><span class=o>=</span><span class=s2>&#34;id&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>model_input_table</span> <span class=o>=</span> <span class=n>model_input_table</span><span class=o>.</span><span class=n>dropna</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>model_input_table</span>
</span></span></code></pre></div></li></ul><ul><li><p>pipeline.py</p><blockquote><p>A Kedro pipeline organises the dependencies and execution order of a collection
of nodes, and connects inputs and outputs. The pipeline determines the node
execution order by resolving dependencies.</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>kedro.pipeline</span> <span class=kn>import</span> <span class=n>Pipeline</span><span class=p>,</span> <span class=n>node</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>kedro.pipeline.modular_pipeline</span> <span class=kn>import</span> <span class=n>pipeline</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>.nodes</span> <span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>preprocess_companies</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>preprocess_shuttles</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>create_model_input_table</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>create_pipeline</span><span class=p>(</span><span class=o>**</span><span class=n>kwargs</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Pipeline</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>pipeline</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=n>node</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                <span class=n>func</span><span class=o>=</span><span class=n>preprocess_companies</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=n>inputs</span><span class=o>=</span><span class=s2>&#34;companies&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=n>outputs</span><span class=o>=</span><span class=p>[</span><span class=s2>&#34;preprocessed_companies&#34;</span><span class=p>,</span><span class=s2>&#34;companies_columns&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=n>name</span><span class=o>=</span><span class=s2>&#34;preprocess_companies_node&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=n>node</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                <span class=n>func</span><span class=o>=</span><span class=n>preprocess_shuttles</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=n>inputs</span><span class=o>=</span><span class=s2>&#34;shuttles&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=n>outputs</span><span class=o>=</span><span class=s2>&#34;preprocessed_shuttles&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=n>name</span><span class=o>=</span><span class=s2>&#34;preprocess_shuttles_node&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=n>node</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                <span class=n>func</span><span class=o>=</span><span class=n>create_model_input_table</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=n>inputs</span><span class=o>=</span><span class=p>[</span><span class=s2>&#34;preprocessed_shuttles&#34;</span><span class=p>,</span> <span class=s2>&#34;preprocessed_companies&#34;</span><span class=p>,</span> <span class=s2>&#34;reviews&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=n>outputs</span><span class=o>=</span><span class=s2>&#34;model_input_table&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=n>name</span><span class=o>=</span><span class=s2>&#34;create_model_input_table_node&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=p>),</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=n>namespace</span><span class=o>=</span><span class=s2>&#34;data_processing&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>inputs</span><span class=o>=</span><span class=p>[</span><span class=s2>&#34;companies&#34;</span><span class=p>,</span> <span class=s2>&#34;shuttles&#34;</span><span class=p>,</span> <span class=s2>&#34;reviews&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=n>outputs</span><span class=o>=</span><span class=s2>&#34;model_input_table&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span></code></pre></div></li></ul></li></ul><ul><li><p>data_science</p><p>This pipeline is for performing data science on the data previously processed.</p><ul><li><p>nodes.py</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>logging</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>typing</span> <span class=kn>import</span> <span class=n>Dict</span><span class=p>,</span> <span class=n>Tuple</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pandas</span> <span class=k>as</span> <span class=nn>pd</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sklearn.linear_model</span> <span class=kn>import</span> <span class=n>LinearRegression</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sklearn.metrics</span> <span class=kn>import</span> <span class=n>r2_score</span><span class=p>,</span> <span class=n>mean_absolute_error</span><span class=p>,</span> <span class=n>max_error</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sklearn.model_selection</span> <span class=kn>import</span> <span class=n>train_test_split</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>split_data</span><span class=p>(</span><span class=n>data</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span> <span class=n>parameters</span><span class=p>:</span> <span class=n>Dict</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Splits data into features and targets training and test sets.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    Args:
</span></span></span><span class=line><span class=cl><span class=s2>        data: Data containing features and target.
</span></span></span><span class=line><span class=cl><span class=s2>        parameters: Parameters defined in parameters/data_science.yml.
</span></span></span><span class=line><span class=cl><span class=s2>    Returns:
</span></span></span><span class=line><span class=cl><span class=s2>        Split data.
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>X</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=n>parameters</span><span class=p>[</span><span class=s2>&#34;features&#34;</span><span class=p>]]</span>
</span></span><span class=line><span class=cl>    <span class=n>y</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=s2>&#34;price&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=n>parameters</span><span class=p>[</span><span class=s2>&#34;test_size&#34;</span><span class=p>],</span> <span class=n>random_state</span><span class=o>=</span><span class=n>parameters</span><span class=p>[</span><span class=s2>&#34;random_state&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>train_model</span><span class=p>(</span><span class=n>X_train</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span> <span class=n>y_train</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>LinearRegression</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Trains the linear regression model.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    Args:
</span></span></span><span class=line><span class=cl><span class=s2>        X_train: Training data of independent features.
</span></span></span><span class=line><span class=cl><span class=s2>        y_train: Training data for price.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    Returns:
</span></span></span><span class=line><span class=cl><span class=s2>        Trained model.
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>regressor</span> <span class=o>=</span> <span class=n>LinearRegression</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>regressor</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>regressor</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>evaluate_model</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>regressor</span><span class=p>:</span> <span class=n>LinearRegression</span><span class=p>,</span> <span class=n>X_test</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span> <span class=n>y_test</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span>
</span></span><span class=line><span class=cl><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>float</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Calculates and logs the coefficient of determination.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    Args:
</span></span></span><span class=line><span class=cl><span class=s2>        regressor: Trained model.
</span></span></span><span class=line><span class=cl><span class=s2>        X_test: Testing data of independent features.
</span></span></span><span class=line><span class=cl><span class=s2>        y_test: Testing data for price.
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>y_pred</span> <span class=o>=</span> <span class=n>regressor</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>score</span> <span class=o>=</span> <span class=n>r2_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>mae</span> <span class=o>=</span> <span class=n>mean_absolute_error</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>me</span> <span class=o>=</span> <span class=n>max_error</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>logger</span> <span class=o>=</span> <span class=n>logging</span><span class=o>.</span><span class=n>getLogger</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&#34;Model has a coefficient R^2 of </span><span class=si>%.3f</span><span class=s2> on test data.&#34;</span><span class=p>,</span> <span class=n>score</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span><span class=s2>&#34;r2_score&#34;</span><span class=p>:</span> <span class=n>score</span><span class=p>,</span> <span class=s2>&#34;mae&#34;</span><span class=p>:</span> <span class=n>mae</span><span class=p>,</span> <span class=s2>&#34;max_error&#34;</span><span class=p>:</span> <span class=n>me</span><span class=p>}</span>
</span></span></code></pre></div></li></ul><ul><li><p>pipeline.py</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>kedro.pipeline</span> <span class=kn>import</span> <span class=n>Pipeline</span><span class=p>,</span> <span class=n>node</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>kedro.pipeline.modular_pipeline</span> <span class=kn>import</span> <span class=n>pipeline</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>.nodes</span> <span class=kn>import</span> <span class=n>evaluate_model</span><span class=p>,</span> <span class=n>split_data</span><span class=p>,</span> <span class=n>train_model</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>create_pipeline</span><span class=p>(</span><span class=o>**</span><span class=n>kwargs</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Pipeline</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>pipeline_instance</span> <span class=o>=</span> <span class=n>pipeline</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=n>node</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                <span class=n>func</span><span class=o>=</span><span class=n>split_data</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=n>inputs</span><span class=o>=</span><span class=p>[</span><span class=s2>&#34;model_input_table&#34;</span><span class=p>,</span> <span class=s2>&#34;params:model_options&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=n>outputs</span><span class=o>=</span><span class=p>[</span><span class=s2>&#34;X_train&#34;</span><span class=p>,</span> <span class=s2>&#34;X_test&#34;</span><span class=p>,</span> <span class=s2>&#34;y_train&#34;</span><span class=p>,</span> <span class=s2>&#34;y_test&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=n>name</span><span class=o>=</span><span class=s2>&#34;split_data_node&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=n>node</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                <span class=n>func</span><span class=o>=</span><span class=n>train_model</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=n>inputs</span><span class=o>=</span><span class=p>[</span><span class=s2>&#34;X_train&#34;</span><span class=p>,</span> <span class=s2>&#34;y_train&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=n>outputs</span><span class=o>=</span><span class=s2>&#34;regressor&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=n>name</span><span class=o>=</span><span class=s2>&#34;train_model_node&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=n>node</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                <span class=n>func</span><span class=o>=</span><span class=n>evaluate_model</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=n>inputs</span><span class=o>=</span><span class=p>[</span><span class=s2>&#34;regressor&#34;</span><span class=p>,</span> <span class=s2>&#34;X_test&#34;</span><span class=p>,</span> <span class=s2>&#34;y_test&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=n>outputs</span><span class=o>=</span><span class=s2>&#34;metrics&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=n>name</span><span class=o>=</span><span class=s2>&#34;evaluate_model_node&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>ds_pipeline_1</span> <span class=o>=</span> <span class=n>pipeline</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>pipe</span><span class=o>=</span><span class=n>pipeline_instance</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>inputs</span><span class=o>=</span><span class=s2>&#34;model_input_table&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>namespace</span><span class=o>=</span><span class=s2>&#34;active_modelling_pipeline&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>ds_pipeline_2</span> <span class=o>=</span> <span class=n>pipeline</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>pipe</span><span class=o>=</span><span class=n>pipeline_instance</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>inputs</span><span class=o>=</span><span class=s2>&#34;model_input_table&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>namespace</span><span class=o>=</span><span class=s2>&#34;candidate_modelling_pipeline&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>pipeline</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>pipe</span><span class=o>=</span><span class=n>ds_pipeline_1</span> <span class=o>+</span> <span class=n>ds_pipeline_2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>inputs</span><span class=o>=</span><span class=s2>&#34;model_input_table&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>namespace</span><span class=o>=</span><span class=s2>&#34;data_science&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span></code></pre></div></li></ul></li></ul><ul><li><p>pipeline_registry.py</p><p>This is the pipeline registry, where you add the appropriate pipelines defined
further down into the register function. This is how kedro recognizes which
pipelines to run.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>typing</span> <span class=kn>import</span> <span class=n>Dict</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>kedro.pipeline</span> <span class=kn>import</span> <span class=n>Pipeline</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>literate_kedro.pipelines</span> <span class=kn>import</span> <span class=n>data_processing</span> <span class=k>as</span> <span class=n>dp</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>literate_kedro.pipelines</span> <span class=kn>import</span> <span class=n>data_science</span> <span class=k>as</span> <span class=n>ds</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>register_pipelines</span><span class=p>()</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Pipeline</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Register the project&#39;s pipelines.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    Returns:
</span></span></span><span class=line><span class=cl><span class=s2>        A mapping from a pipeline name to a ``Pipeline`` object.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>data_processing_pipeline</span> <span class=o>=</span> <span class=n>dp</span><span class=o>.</span><span class=n>create_pipeline</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>data_science_pipeline</span> <span class=o>=</span> <span class=n>ds</span><span class=o>.</span><span class=n>create_pipeline</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;__default__&#34;</span><span class=p>:</span> <span class=n>data_processing_pipeline</span> <span class=o>+</span> <span class=n>data_science_pipeline</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;dp&#34;</span><span class=p>:</span> <span class=n>data_processing_pipeline</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;ds&#34;</span><span class=p>:</span> <span class=n>data_science_pipeline</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span></code></pre></div></li></ul><h2 id=conclusions>Conclusions<a hidden class=anchor aria-hidden=true href=#conclusions>Â¶</a></h2><p>This is pretty much all you need to replicate the kedro tutorial from within a
single org-file. I would be remiss to not mention that kedro itself has a pretty
good alternative of simply using their jupyter plugin, but I tend to use emacs
all the time anyways, so I figured, what the hey.</p><p>There are still a couple things I&rsquo;d like to ponder over insofar as best
practices and future articles like:</p><ul><li>Should you split up the nodes and pipelines further? Using literate
programmign to basically make a utility, processing, etc. code block.</li><li>Version control, only on the tangled files?</li><li>Making use of transclusion from other files.</li><li>Turning the &ldquo;relevant parts&rdquo;&rsquo; into a presentation - slicing the org document
into exploratory analysis that ignores the code depending on audience.</li></ul><p>I&rsquo;ll probably try to write an article doing a &ldquo;real&rdquo; analysis with this workflow
in the future.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>cp ./literate-kedro-spaceflight.org ~/code/justin.vc/static/org/literate-kedro-spaceflight.org
</span></span></code></pre></div><p>This copies the file when I export, which allows you to see the
<a href=https://raw.githubusercontent.com/brickfrog/justin.vc/master/static/org/literate-kedro-spaceflight.org>original org file</a> if curious. That specifically includes how I tangled the files to the
correct places. (And, once again, input welcome if I there&rsquo;s better ways to do it).</p></div><footer class=post-footer><nav class=paginav><a class=prev href=https://justin.vc/posts/brute-forcing-pandoc-with-panflute/><span class=title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-left" style="user-select:text"><line x1="19" y1="12" x2="5" y2="12" style="user-select:text"/><polyline points="12 19 5 12 12 5" style="user-select:text"/></svg>&nbsp;Prev Page</span><br><span>Brute Forcing Pandoc with Panflute</span>
</a><a class=next href=https://justin.vc/posts/ox-hugo-and-org-roam/><span class=title>Next Page&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right" style="user-select:text"><line x1="5" y1="12" x2="19" y2="12" style="user-select:text"/><polyline points="12 5 19 12 12 19" style="user-select:text"/></svg></span><br><span>Using ox-hugo and Org-roam for Writing</span></a></nav></footer><script src=https://giscus.app/client.js data-repo=brickfrog/justin.vc data-repo-id=R_kgDOHssjcQ data-category=General data-category-id=DIC_kwDOHssjcc4CgLxH data-mapping=pathname data-strict=0 data-reactions-enabled=0 data-emit-metadata=0 data-input-position=bottom data-theme=https://justin.vc/themes/theme.css data-lang=en crossorigin=anonymous async></script></article></main><footer class=footer><span>&copy; 2021-2024 <a href=https://justin.vc/>justin.vc</a></span>,<span style=display:inline-block;margin-left:.5em>
<a href=https://creativecommons.org/licenses/by-sa/4.0/>CC BY-SA</a>
</span><span style=display:inline-block;margin-left:.25em>âœ¯</span>
Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a>
<a href=https://github.com/brickfrog/hugo-PaperModulo/ rel=noopener target=_blank>(PaperModulo)</a>,
<a href=https://orgmode.org rel="noopener noreferrer" target=_blank>Org Mode</a>,
<a href=https://www.gnu.org/software/emacs rel=noopener target=_blank>GNU Emacs</a>, and
<a href=https://justin.vc/about/#this-site>others</a>.
</span><span style=display:inline-block;margin-left:.25em>âœ¯</span>
<a href=https://justin.vc//index.xml>RSS</a></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>(function(){let e=document.getElementById("menu");e&&(e.scrollLeft=localStorage.getItem("menu-scroll-position"),e.onscroll=function(){localStorage.setItem("menu-scroll-position",e.scrollLeft)});const t=""=="1",n=""=="1";if(window.matchMedia("(prefers-reduced-motion: reduce)").matches||t||n)return;document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})})()</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>if(window.scrollListeners)for(const e of scrollListeners)window.removeEventListener("scroll",e);window.scrollListeners=[]</script><script src=/js/medium-zoom.min.js data-no-instant></script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerText="copy";function s(){t.innerText="copied!",setTimeout(()=>{t.innerText="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script><script>(function(){const a="1"=="1";if(!a)return;if(!document.querySelector(".toc")){console.log("no toc found, ignore toc scroll");return}const r=window.scrollListeners,t=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id]"),n="active";let e=t[0];o(e).classList.add(n);const c=()=>{const s=[];for(const e of t)if(l(e)<5)s.push(e);else break;s.length>0?newActiveHeading=s[s.length-1]:newActiveHeading=t[0],e!=newActiveHeading&&(o(e).classList.remove(n),e=newActiveHeading,o(e).classList.add(n))};let s=null;const i=()=>{s!==null&&clearTimeout(s),s=setTimeout(c,50)};window.addEventListener("scroll",i,!1),r.push(i);function o(e){const t=encodeURI(e.getAttribute("id")).toLowerCase();return document.querySelector(`.toc ul li a[href="#${t}"]`)}function l(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect();return t.top}})()</script></body></html>